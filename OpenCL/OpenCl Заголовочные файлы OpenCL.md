
[[#Заголовочные файлы OpenCL|Заголовочные файлы OpenCL]] 9



# Заголовочные файлы OpenCL

Комплект заголовочных файлов, необходимых для написания программ с использованием `OpenCL`, можно найти на сайте https://www.khronos.org/registry/OpenCL/ консорциума Khronos. Указанная страница содержит ссылки на спецификации: функций программного интерфейса; языка, используемого для написания ядер (OpenCL C ); OpenCL-расширений (как одобренных производителями, так и самим консорциумом), — а также ссылки на различные версии заголовочных файлов. В системах Ubuntu или Debian заголовочные файлы OpenCL можно также установить с помощью команды
```
sudo apt-get install opencl-headers
```

Если на компьютере установлен `CUDA SDK`, то заголовочные файлы OpenCL там уже есть.

В зависимости от версии OpenCL в комплект заголовочных файлов входит от 7 до 10 файлов. Мы оставим в стороне те из них, что имеют отношение к Direct3D: `cl_d3d10.h`, `cl_d3d11.h`, `cl_dx9_media_sharing.h` — здесь они вообще не рассматриваются. Из оставшихся наиболее часто используется один — залоговочный файл `cl.h`, поскольку именно в нём описано подавляющее большинство функций программного интерфейса (см. таблицу). Остальные файлы понадобятся, если работать в программе с расширениями OpenCL (extensions) и/или организовывать взаимодействие с OpenGL для воспроизведения графической информации. Об этом чуть подробнее мы будем говорить позднее — в соответствующих разделах.

| `Версия OpenCL` | 1.0 | 1.1 | 1.2 | 2.0 | 2.1 | 2.2 |
| --------------- | --- | --- | --- | --- | --- | --- |
| Файлы           |     |     |     |     |     |     |
| cl.h            | 66  | 74  | 88  | 101 | 108 | 110 |
| cl_egl.h        | -   | -   | 4   | 4   | 4   | 4   |
| cl_ext.h        | 5   | 11  | 24  | 25  | 25  | 25  |
| cl_gl.h         | 9   | 9   | 10  | 10  | 10  | 10  |
| cl_gl_ext.h     | 0   | 1   | 1   | 1   | 1   | 1   |
| cl_platform.h   | 0   | 0   | 0   | 0   | 0   | 0   |
| opencl.h        | 0   | 0   | 0   | 0   | 0   | 0   |

Дополняет этот комплект файл `cl.hpp` (в последних версиях OpenCL он постепенно заменяется файлом `cl2.hpp`), поскольку в нём реализуется C++-интерфейс к функциям API; особенности работы с ним рассматриваются в следующем разделе.

Стандартным местом расположения этих файлов является подкаталог CL в каталоге, где располагаются заголовочные файлы вообще (в Mac OS подкаталог имеет немного другое название: OpenCL); для реализации OpenCL в рамках CUDA — это местоположение заголовочных файлов CUDA, поэтому при компиляции OpenCL-программы (под Windows) там достаточно включить в путь поиска заголовочных файлов путь `%CUDA_INC_PATH%` (при компиляции с командной строки) или `$(CUDA_INC_PATH)` (при компиляции из среды Visual Studio). При компиляции под Linux путь к заголовочным файлам часто можно не указывать вообще, поскольку они почти всегда расположены там, где компилятор ищет их по умолчанию (каталоги `/usr/include`, `/usr/local/include`). Отметим, что подкаталог CL (или OpenCL для Mac OS ) указывается прямо в тексте программы в директиве препроцессора.

Взаимосвязь рассматриваемых заголовочных файлов `cl.h`, `cl_platform.h`, `cl_ext.h`, `cl_gl.h`, `cl_gl_ext.h`, `opencl.h` (здесь они перечислены в порядке важности для нас) иллюстрируется диаграммой

![[OpenCL_1.png]]

и взаимозависимость файлов показана рёбрами направленного графа, а сами файлы — узлами графа. Направление ребра в этом графе означает включение (в смысле директивы `#include`) файла в другой файл. Видно, что самый часто используемый заголовочный файл `cl.h` включает в себя только файл `cl_platform.h` (т.е., зависит только от него). Все остальные заголовочные файлы всегда подключают `cl.h`, а файл `opencl.h` вообще подключает все остальные файлы. Таким образом, резюмируя, можно сказать, что для программ, которые не используют никаких расширений и взаимодействия с OpenGL, необходимыми являются только два файла: `cl.h` и `cl_platform.h`, причём директивы препроцессора (`#include <CL/cl.h>`) достаточно одной, поскольку `cl_platform.h` подключается автоматически. Если же программы используют явную работу с расширениями и/или должны взаимодействовать с OpenGL, то проще сразу пользоваться заголовочным файлом `opencl.h`; его одного будет достаточно для компиляции программ.































