
[[#QInputDialog]]
1. [[#Основные методы и сигналы|Основные методы и сигналы]] 10.4.1
2. [[#Окна для ввода строки|Окна для ввода строки]] 10.4.2
3. [[#Окно для ввода целого числа|Окно для ввода целого числа]] 10.4.3
4. [[#Окно для ввода вещественного числа|Окно для ввода вещественного числа]] 10.4.4
5. [[#Окно для выбора пункта из списка|Окно для выбора пункта из списка]] 10.4.5

# QInputDialog

Класс `QInputDialog` реализует модальные диалоговые окна для ввода различных данных. Иерархия наследования для класса `QInputDialog` выглядит так:
```
(QObject, QPaintDevice) — QWidget — QDialog — QInputDialog
```

Формат конструктора класса `QInputDialog`:
```c++
#include <QInputDialog>

QInputDialog(QWidget *parent = nullptr, Qt::WindowFlags flags = Qt::WindowFlags())
```

Если в параметре parent передан указатель на родительское окно, то диалоговое окно будет центрироваться относительно родительского окна, а не относительно экрана. Параметр `flags` задает [[QWidget#Указание типа окна|тип окна]].

После создания экземпляра класса следует вызвать метод `exec()` для отображения окна. Метод возвращает код возврата в виде значения следующих констант: `Accepted` или `Rejected`. Пример отображения диалогового окна и обработки статуса внутри обработчика нажатия кнопки:
```c++
void Widget::on_btn1_clicked()
{
	QInputDialog dialog(this);
	int result = dialog.exec();
	
	if (result == QDialog::Accepted) {
		qDebug() << "Нажата кнопка OK";
		// Здесь получаем данные из диалогового окна
	}
	else {
		qDebug() << "Нажата кнопка Cancel";
	}
}
```

## Основные методы и сигналы

Класс `QInputDialog` наследует все методы из базовых классов и содержит следующие дополнительные методы (перечислены только основные методы; полный список смотрите в документации):

> **setLabelText()** — задает текст, отображаемый над полем ввода. Прототип метода:
```c++
void setLabelText(const QString &text)
```

> **setOkButtonText()** — задает текст, отображаемый на кнопке `OK`. Прототип метода:
```c++
void setOkButtonText(const QString &text)
```

> **setCancelButtonText()** — задает текст, отображаемый на кнопке `Cancel`. Прототип метода:
```c++
void setCancelButtonText(const QString &text)
```

> **setInputMode()** — задает режим ввода данных. Прототип метода:
```c++
void setInputMode(QInputDialog::InputMode mode)
```

В качестве параметра указываются следующие константы:
* **QInputDialog::TextInput** — ввод текста;
* **QInputDialog::IntInput** — ввод целого числа;
* **QInputDialog::DoubleInput** — ввод вещественного числа;

> **setTextEchoMode()** — задает режим отображения текста в поле. Прототип метода:
```c++
void setTextEchoMode(QLineEdit::EchoMode mode)
```

Могут быть указаны следующие константы:

* **QLineEdit::Normal** — показывать символы, как они были введены;
* **QLineEdit::NoEcho** — не показывать вводимые символы;
* **QLineEdit::Password** — вместо символов указывать символ `*`;
* **QLineEdit::PasswordEchoOnEdit** — показывать символы при вводе, а при потере фокуса отображать символ `*`;

> **setTextValue()** — задает текст по умолчанию, отображаемый в текстовом поле. Прототип метода:
```c++
void setTextValue(const QString &text)
```

> **textValue()** — возвращает текст, введенный в текстовое поле. Прототип метода:
```c++
QString textValue() const
```

> **setIntValue()** — задает целочисленное значение при использовании режима `IntInput`. Прототип метода:
```c++
void setIntValue(int value)
```

> **intValue()** — возвращает целочисленное значение, введенное в поле, при использовании режима `IntInput`. Прототип метода:
```c++
int intValue() const
```

> **setIntRange()**, **setIntMinimum()** и **setIntMaximum()** — задают диапазон допустимых целочисленных значений при использовании режима `IntInput`. Прототипы методов:
```c++
void setIntRange(int min, int max)
void setIntMinimum(int min)
void setIntMaximum(int max)
```

> **setIntStep()** — задает шаг приращения значения при нажатии кнопок со стрелками в правой части поля при использовании режима `IntInput`. Прототип метода:
```c++
void setIntStep(int step)
```

> **setDoubleValue()** — задает вещественное значение при использовании режима `DoubleInput`. Прототип метода:
```c++
void setDoubleValue(double value)
```

> **doubleValue()** — возвращает вещественное значение, введенное в поле, при использовании режима `DoubleInput`. Прототип метода:
```c++
double doubleValue() const
```

> **setDoubleRange()**, **setDoubleMinimum()** и **setDoubleMaximum()** — задают диапазон допустимых вещественных значений при использовании режима `DoubleInput`. Прототипы методов:
```c++
void setDoubleRange(double min, double max)
void setDoubleMinimum(double min)
void setDoubleMaximum(double max)
```

> **setDoubleStep()** — задает шаг приращения значения при нажатии кнопок со стрелками в правой части поля при использовании режима `DoubleInput`. Прототип метода:
```c++
void setDoubleStep(double step)
```

> **setDoubleDecimals()** — задает количество цифр после десятичной точки при использовании режима `DoubleInput`. Прототип метода:
```c++
void setDoubleDecimals(int decimals)
```

> **setComboBoxItems()** — задает строки, которые будут отображаться в раскрывающемся списке. Прототип метода:
```c++
void setComboBoxItems(const QStringList &items)
```

> **setComboBoxEditable()** — если в качестве параметра указано значение `true`, то значения из раскрывающегося списка можно будет редактировать. Прототип метода:
```c++
void setComboBoxEditable(bool editable)
```

> **setOption()** — если во втором параметре указано значение `true`, то производит установку указанной в первом параметре опции, а если `false`, то сбрасывает опцию. Прототип метода:
```c++
void setOption(QInputDialog::InputDialogOption option, bool on = true)
```

В первом параметре можно указать следующие константы:
* **QInputDialog::NoButtons** — кнопки не отображаются;
* **QInputDialog::UseListViewForComboBoxItems** — для отображения списка строк будет использоваться класс [[QListView|QListView]], а не [[QComboBox|QComboBox]];
* **QInputDialog::UsePlainTextEditForTextInput** — для ввода строки использовать компонент [[QPlainTextEdit|QPlainTextEdit]];

> **setOptions()** — устанавливает несколько опций сразу.
```c++
void setOptions(QInputDialog::InputDialogOptions options)
```

Класс `QInputDialog` содержит следующие сигналы:

> **textValueChanged(const QString&)** — генерируется при изменении значения в текстовом поле. Внутри обработчика через параметр доступно новое значение. Сигнал генерируется при использовании режима `TextInput`;
>
> **textValueSelected(const QString&)** — генерируется при нажатии кнопки `OK`. Внутри обработчика через параметр доступно введенное значение. Сигнал генерируется при использовании режима `TextInput`;
> 
> **intValueChanged(int)** — генерируется при изменении значения в поле. Внутри обработчика через параметр доступно новое значение. Сигнал генерируется при использовании режима `IntInput`;
> 
> **intValueSelected(int)** — генерируется при нажатии кнопки `OK`. Внутри обработчика через параметр доступно введенное значение. Сигнал генерируется при использовании режима `IntInput`;
> 
> **doubleValueChanged(double)** — генерируется при изменении значения в поле. Внутри обработчика через параметр доступно новое значение. Сигнал генерируется при использовании режима `DoubleInput`;
> 
> **doubleValueSelected(double)** — генерируется при нажатии кнопки `OK`. Внутри обработчика через параметр доступно введенное значение. Сигнал генерируется при использовании режима `DoubleInput`.

## Окна для ввода строки

Помимо рассмотренных методов класс ё содержит несколько статических методов, реализующих готовые диалоговые окна. Окно для ввода обычной строки или пароля реализуется с помощью статического метода ё. Прототип метода:
```c++
static QString getText(QWidget *parent,
			const QString &title, const QString &label,
			QLineEdit::EchoMode mode = QLineEdit::Normal,
			const QString &text = QString(), bool *ok = nullptr,
			Qt::WindowFlags flags = Qt::WindowFlags(),
			Qt::InputMethodHints inputMethodHints = Qt::ImhNone)
```

В параметре `parent` передается указатель на родительское окно или нулевой указатель. Если передан указатель, то диалоговое окно будет центрироваться относительно родительского окна, а не относительно экрана. Необязательный параметр `mode` задает режим отображения текста в поле (см. описание метода `setTextEchoMode()`). Параметр `text` устанавливает значение поля по умолчанию, а в параметре `flags` можно указать тип окна. Статус операции доступен через параметр `ok` (переменная будет иметь значение `true`, если была нажата кнопка `OK`, или значение `false`, если была нажата кнопка `Cancel`, клавиша `<Esc>` или кнопка `Закрыть` в заголовке окна). Метод `getText()` возвращает значение, введенное в поле. Пример:
```c++
bool ok;
QString text = QInputDialog::getText(this, "Это заголовок окна",
					"Это текст подсказки", QLineEdit::Normal,
					"Значение по умолчанию", &ok);

if (ok) {
	qDebug() << "Введено значение:" << text;
}
```

Результат выполнения этого кода показан на рис.
![[ParallelProg_201.png]]

Окно для ввода многострочного текста реализуется с помощью статического метода `getMultiLineText()`. Прототип метода:
```c++
static QString getMultiLineText(QWidget *parent,
						const QString &title, const QString &label,
						const QString &text = QString(), bool *ok = nullptr,
						Qt::WindowFlags flags = Qt::WindowFlags(),
						Qt::InputMethodHints inputMethodHints = Qt::ImhNone)
```

Пример:
```c++
bool ok;
QString text = QInputDialog::getMultiLineText(
						this, "Это заголовок окна",
						"Это текст подсказки",
						"Значение по умолчанию", &ok);
						
if (ok) {
	qDebug() << "Введено значение:" << text;
}
```

## Окно для ввода целого числа

Окно для ввода целого числа реализуется с помощью статического метода `getInt()`. Прототип метода:
```c++
static int getInt(QWidget *parent,
				const QString &title, const QString &label,
				int value = 0, int min = -2147483647, int max = 2147483647,
				int step = 1, bool *ok = nullptr,
				Qt::WindowFlags flags = Qt::WindowFlags())
```

В параметре `parent` передается указатель на родительское окно или нулевой указатель. Если передан указатель, то диалоговое окно будет центрироваться относительно родительского окна, а не относительно экрана. Необязательный параметр `value` устанавливает значение поля по умолчанию. Параметр `min` задает минимальное значение, параметр `max` — максимальное значение, а параметр `step` — шаг приращения. Параметр `flags` позволяет указать тип окна. Статус операции доступен через параметр `ok` (переменная будет иметь значение `true`, если была нажата кнопка `OK`, или значение `false`, если была нажата кнопка `Cancel`, клавиша `<Esc>` или кнопка Закрыть в заголовке окна). Метод возвращает значение, введенное в поле. Пример:
```c++
bool ok;
int n = QInputDialog::getInt(this, "Это заголовок окна",
					"Это текст подсказки",
					50, 0, 100, 2, &ok);
if (ok) {
	qDebug() << "Введено значение:" << n;
}
```

Результат выполнения этого кода показан на рис.

![[ParallelProg_202.png]]

## Окно для ввода вещественного числа

Окно для ввода вещественного числа реализуется с помощью статического метода `getDouble()`. Прототип метода:
```C++
static double getDouble(QWidget *parent,
			const QString &title, const QString &label,
			double value = 0, double min = -2147483647, double max = 2147483647,
			int decimals = 1, bool *ok = nullptr,
			Qt::WindowFlags flags = Qt::WindowFlags(), double step = 1)
```

В параметре `parent` передается указатель на родительское окно или нулевой указатель. Если передан указатель, то диалоговое окно будет центрироваться относительно родительского окна, а не относительно экрана. Необязательный параметр `value` устанавливает значение поля по умолчанию. Параметр `min` задает минимальное значение, параметр `max` — максимальное значение, а параметр `decimals` — количество цифр после десятичной точки. Параметр `flags` позволяет указать тип окна. Статус операции доступен через параметр `ok` (переменная будет иметь значение `true`, если была нажата кнопка `OK`, или значение `false`, если была нажата кнопка `Cancel`, клавиша `<Esc>` или кнопка `Закрыть` в заголовке окна). Метод возвращает значение, введенное в поле. Пример:

```C++
bool ok;
double n = QInputDialog::getDouble(this, "Это заголовок окна",
			"Это текст подсказки",
			50.0, 0.0, 100.0, 2, &ok);
if (ok) {
	qDebug() << "Введено значение:" << n;
}
```

## Окно для выбора пункта из списка

Окно для выбора пункта из списка реализуется с помощью статического метода `getItem()`. Прототип метода:
```C++
static QString getItem(QWidget *parent,
			const QString &title, const QString &label,
			const QStringList &items, int current = 0,
			bool editable = true, bool *ok = nullptr,
			Qt::WindowFlags flags = Qt::WindowFlags(),
			Qt::InputMethodHints inputMethodHints = Qt::ImhNone)
```

В параметре `parent` передается указатель на родительское окно или нулевой указатель. Если передан указатель, то диалоговое окно будет центрироваться относительно родительского окна, а не относительно экрана. Необязательный параметр `current` устанавливает индекс пункта, выбранного по умолчанию. Если в параметре `editable` указано значение `true`, то текст пункта списка можно редактировать. Параметр `flags` позволяет указать тип окна. Статус операции доступен через параметр `ok` (переменная будет иметь значение `true`, если была нажата кнопка `OK`, или значение `false`, если была нажата кнопка `Cancel`, клавиша `<Esc>` или кнопка `Закрыть` в заголовке окна). Метод возвращает текст выбранного пункта в списке. Пример:
```C++
bool ok;
QStringList list;
list << "Пункт 1" << "Пункт 2" << "Пункт 3";

QString text = QInputDialog::getItem(this,
	"Это заголовок окна", "Это текст подсказки",
	list, 1, false, &ok);
	
if (ok) {
	qDebug() << "Выбрано значение:" << text;
}
```

Результат выполнения этого кода показан на рис.

![[gui_3.png]]

